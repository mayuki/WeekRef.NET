<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="twitter:card" content="summary">
    <meta name="description" content=".NET &#x95A2;&#x9023;&#x306E;&#x60C5;&#x5831;&#x3092;&#x307B;&#x307C;&#x9031;&#x520A;&#x914D;&#x4FE1;">
    <meta property="og:description" content=".NET &#x95A2;&#x9023;&#x306E;&#x60C5;&#x5831;&#x3092;&#x307B;&#x307C;&#x9031;&#x520A;&#x914D;&#x4FE1;">
    <meta name="author" content="Mayuki Sawatari">

  <title>2021-11-27: Pyjion, Evergine, paint.net 4.3.3 - WeekRef.NET</title>

  <link rel="canonical" href="https://weekref.net/2021/11/27/updates">

      <link type="application/atom+xml" rel="alternate" title="WeekRef.NET" href="/feed.atom" />
  
  <meta name="application-name" content="WeekRef.NET" />
  <meta name="msapplication-tooltip" content="WeekRef.NET" />
  <meta name="msapplication-starturl" content="/" />

  <meta property="og:title" content="2021-11-27: Pyjion, Evergine, paint.net 4.3.3 - WeekRef.NET" />
    <meta property="og:image" content="/img/logo.png" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://weekref.net/2021/11/27/updates" />
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>
  
  <!-- Custom styles for this template -->
  <link href="/scss/clean-blog.css" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

  <!-- Lunr search -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VMZ41K2L9M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VMZ41K2L9M');
</script>


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">WeekRef.NET</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
    <li class="nav-item">
        <a class="nav-link" href="https://github.com/mayuki/WeekRef.NET">GitHub</a>
    </li>
</ul>
    </div>
  </div>
</nav>

  <!-- Page Header -->
  <header class="masthead">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="post-heading">
          <h1>
            2021-11-27: Pyjion, Evergine, paint.net 4.3.3
          </h1>
              <div class="meta">Published on Saturday, 27 November 2021</div>
        </div>
      </div>
    </div>
  </div>
</header>

  <!-- Main Content -->
  <div class="container"> 
    <div class="row">
      <div id="content" class="col-md-12">  
        <!--
# yyyy-MM-dd
## 主なトピックス
## ヘッドライン
## アーティクル、スライドなど
## ライブラリ、リポジトリ、ツールなど
## サイト、ドキュメントなど
### ツイート
## Deep Dive
-->
<h2 id="section">トピックス</h2>
<h3 id="pyjion-a-python-jit-compiler">Pyjion - A Python JIT Compiler</h3>
<p><a href="https://www.trypyjion.com/">https://www.trypyjion.com/</a></p>
<p>CPython に .NET ランタイムの JIT コンパイラーを組み込み利用することで高速化するというライブラリ。</p>
<p>Python のコードの変更は有効化する一行程度で対応可能で、<code>pyjion</code> コマンドによる直接実行もサポートしている。</p>
<p>元々は Microsoft の Organization で開発されていたが、現在は Anthony Shaw 氏 (Microsoft の Python Advocate) の個人リポジトリーに移動して開発が続き、リリースされている。</p>
<ul>
<li><a href="https://github.com/tonybaloney/Pyjion">tonybaloney/Pyjion: Pyjion - A JIT for Python based upon CoreCLR</a></li>
</ul>
<h3 id="discover-evergine.more-than-ever-evergine">Discover Evergine... more than ever! - Evergine</h3>
<p><a href="https://evergine.com/discover-evergine/">https://evergine.com/discover-evergine/</a></p>
<p>Wave Engine という名前の 3D グラフィックスエンジンが Evergine という名前でリブランディングした。</p>
<p>Evergine は C# と .NET をベースとしたエンジンでクロスプラットフォームに対応している。このリリースでは .NET 6 と C# 10, Visual Studio 2022 への対応が含まれるとのこと。</p>
<h3 id="paint.net-4.3.3-is-now-available">paint.net 4.3.3 is now available!</h3>
<p><a href="https://forums.getpaint.net/topic/118933-paintnet-433-is-now-available/">https://forums.getpaint.net/topic/118933-paintnet-433-is-now-available/</a></p>
<p>Paint.NET 4.3.3 がリリースされた。</p>
<p>このバージョンで .NET 6 への移行が行われ、レンダリングや起動のパフォーマンスの向上の他、プラグインの C# 10 での実装が可能となった。また、COM 以外の相互運用コードを TerraFX.Interop.Windows に移行し、今後 COＭ 相互運用コードも移行することで C++/CLI を排除でき、crossgen2/ReadyToRun の恩恵を受けられるようになるとのこと。</p>
<ul>
<li><a href="https://github.com/terrafx/terrafx.interop.windows">terrafx/terrafx.interop.windows: Interop bindings for Windows.</a></li>
</ul>
<h2 id="section-1">アーティクル、スライドなど</h2>
<h3 id="callerargumentexpression-and-throw-helpers-exploring.net-core-6-part-11">[CallerArgumentExpression] and throw helpers: Exploring .NET Core 6 - Part 11</h3>
<p><a href="https://andrewlock.net/exploring-dotnet-6-part-11-callerargumentexpression-and-throw-helpers/">https://andrewlock.net/exploring-dotnet-6-part-11-callerargumentexpression-and-throw-helpers/</a></p>
<p>.NET 6 で追加された <code>CallerArgumentExpression</code> 属性についてとそれを使用した例外を投げるヘルパーについての記事。</p>
<p>例外ヘルパーによる利点として、メソッドのコードが簡素になる、JIT でインライン化しやすくなるといった点にも触れている。</p>
<h3 id="c-qiita">【C#】本物の関数ポインタの使い方と関数アドレスの取り方 - Qiita</h3>
<p><a href="https://qiita.com/Kujiro/items/9e442b0e9fb98ad904d8">https://qiita.com/Kujiro/items/9e442b0e9fb98ad904d8</a></p>
<p>C# 9 で導入された関数ポインター型 (<code>delegate*</code>) についてとその使用方法について。</p>
<h3 id="configuring-dotnet-monitor-with-prometheus-and-grafana-dotnetos">Configuring dotnet-monitor with Prometheus and Grafana - Dotnetos</h3>
<p><a href="https://dotnetos.org/blog/2021-11-22-dotnet-monitor-grafana/">https://dotnetos.org/blog/2021-11-22-dotnet-monitor-grafana/</a></p>
<p><code>dotnet-monitor</code> を Prometheus と Grafana を組み合わせて .NET のメトリクスを視覚化する方法についての記事。</p>
<p>記事ではサンプルアプリケーションを使用して Prometheus に <code>dotnet-monitor</code> のデータを格納し、Grafana で視覚化するまでをステップバイステップで説明している。</p>
<h3 id="c-10.0">【C# 10.0】 トップ レベル ステートメントの変更点</h3>
<p><a href="https://ufcpp.net/blog/2021/11/top-level-csharp10/">https://ufcpp.net/blog/2021/11/top-level-csharp10/</a></p>
<p>C# 10 のトップレベルステートメントに関する記事。</p>
<p>C# 9 からの変更点として空ステートメントについてとトップレベルステートメントを含むクラス名について触れている。</p>
<h3 id="unityunityengine.object-null">【Unity】UnityEngine.Object の Null チェックまとめ - コガネブログ</h3>
<p><a href="https://baba-s.hatenablog.com/entry/2021/11/16/090000">https://baba-s.hatenablog.com/entry/2021/11/16/090000</a></p>
<p>Unity の UnityEngine.Object は比較演算子のオーバーロードを持ち、null に対する独特な比較を実装しているため、その挙動についてまとめた記事。</p>
<p>オブジェクトを Destory した後のタイミングごとの結果や <code>??</code> のような演算子での結果にも触れている。</p>
<h3 id="net-6-hot-reload-and-refused-to-connect-to-ws-because-it-violates-the-content-security-policy-directive-because-web-sockets">.NET 6 Hot Reload and &quot;Refused to connect to ws: because it violates the Content Security Policy directive&quot; because Web Sockets</h3>
<p><a href="https://www.hanselman.com/blog/net-6-hot-reload-and-refused-to-connect-to-ws-because-it-violates-the-content-security-policy-directive-because-web-sockets">https://www.hanselman.com/blog/net-6-hot-reload-and-refused-to-connect-to-ws-because-it-violates-the-content-security-policy-directive-because-web-sockets</a></p>
<p>Content Security Policy (CSP) を設定していることでホットリロードのための WebSocket 通信ができなくなってしまうという記事。</p>
<h3 id="quictlsopenssl">QUICスタックとTLSライブラリの関係とOpenSSLの状況</h3>
<p><a href="https://medium.com/nttlabs/quic-tls-relation-and-openssl-circumstance-fca824169b46">https://medium.com/nttlabs/quic-tls-relation-and-openssl-circumstance-fca824169b46</a></p>
<p>QUIC のスタックとそれに関連した TLS の位置づけと依存しているライブラリーの状況についての記事。</p>
<p>QUIC での TLS の処理の流れや QUIC に必要な機能を OpenSSL に追加する必要がある中での現状などに触れている。</p>
<h3 id="net-6-blazor-webassembly">.NET 6 で Blazor WebAssembly 環境構築でエラーした話</h3>
<p><a href="https://zenn.dev/naminodarie/articles/0fa46bf42b18e0">https://zenn.dev/naminodarie/articles/0fa46bf42b18e0</a></p>
<p>.NET 6 で Blazor WebAssembly の wasm-tools をインストールする際に Preview 版がインストールされているとエラーとなることがあるという話。</p>
<h3 id="winui3-desktop-windows-app-sdk-qiita">WinUI3 Desktopで開発したアプリのインストール戦略 (Windows App SDK) - Qiita</h3>
<p><a href="https://qiita.com/hayashida-katsutoshi/items/eba4fe2e9332e87cdc8f">https://qiita.com/hayashida-katsutoshi/items/eba4fe2e9332e87cdc8f</a></p>
<p>WinUI 3 を使用したアプリケーションのインストール形態についての記事。</p>
<ul>
<li><a href="https://qiita.com/hayashida-katsutoshi/items/0d4e47d7c9e1a33c6f51">WinUI3 Desktopでダークモードに対応する (Windows App SDK) - Qiita</a></li>
<li><a href="https://qiita.com/hayashida-katsutoshi/items/c6c6190023874f0aa87b">WinUI3 Desktopでウィンドウのサイズを変更する (Windows App SDK) - Qiita</a></li>
</ul>
<h3 id="c.net6blazor-webassemblyjs200-qiita">【C#】.NET6のBlazor WebAssemblyのJS呼び出しは200倍早い - Qiita</h3>
<p><a href="https://qiita.com/Kujiro/items/0d6510525aa8d8289b01">https://qiita.com/Kujiro/items/0d6510525aa8d8289b01</a></p>
<p>.NET 6 では Blazor WebAssembly 環境で .NET 側のコードから JavaScript 側にバイト列を渡す際に Uint8Array となったことでパフォーマンスが向上されたという話。</p>
<h3 id="c-10.0-appendliteral">【C# 10.0】 AppendLiteral(&quot; &quot;)</h3>
<p><a href="https://ufcpp.net/blog/2021/11/AppendLiteral/">https://ufcpp.net/blog/2021/11/AppendLiteral/</a></p>
<p>C# 10 / .NET 6 で改善された文字列補完式で使用される <code>DefaultInterpolatedStringHandler</code> の <code>AppendLiteral</code> メソッドについての記事。</p>
<p><code>AppendLiteral(string)</code> があって <code>AppendLiteral(char)</code> がない理由について。</p>
<h3 id="entity-framework-core-c-sql-sql-jsakamoto">Entity Framework Core 上で C# の文字列補間を使って安全に SQL 文を実行するが、SQL 文そのものを動的に組み立てたい | &#64;jsakamoto</h3>
<p><a href="https://devadjust.exblog.jp/28969310/">https://devadjust.exblog.jp/28969310/</a></p>
<p>Entity Framework Core では <code>ExecuteSqlInterpolatedAsync</code> メソッドを使用することで文字列補完で安全に SQL のパラメータを指定できる仕組みがあるが、そのメソッドに渡す文字列を動的に変更したい場合にはどうすればいいのかという記事。</p>
<p>記事では <code>FormattableStringFactory.Create</code> を使用して <code>FormattableString</code> を生成する方法が紹介されている。</p>
<h3 id="meet-rider-2021.3s-new-problems-view-the.net-tools-blog">Meet Rider 2021.3’s new Problems View | The .NET Tools Blog</h3>
<p><a href="https://blog.jetbrains.com/dotnet/2021/11/24/meet-rider-2021-3-new-problems-view/">https://blog.jetbrains.com/dotnet/2021/11/24/meet-rider-2021-3-new-problems-view/</a></p>
<p>Rider 2021.3 で導入される Problems View の紹介記事。</p>
<p>Problems View ではファイルの問題をはじめ、ソリューションやツールキットといったものの問題を一元的に確認できるビューになるとのこと。</p>
<h3 id="cstringspant-qiita">【C#】配列、stringの内部実装とSpan&lt;T&gt;のありがたみ - Qiita</h3>
<p><a href="https://qiita.com/Kujiro/items/e1998b14176419b3ad1a">https://qiita.com/Kujiro/items/e1998b14176419b3ad1a</a></p>
<p>String の内部表現とデータを取り扱う上での <code>Span&lt;T&gt;</code> の必要性についての記事。</p>
<h3 id="manually-removing.net-sdks-from-macos">Manually Removing .NET SDKs from MacOS</h3>
<p><a href="https://dev.to/justinyoo/manually-removing-net-sdks-from-macos-4jce">https://dev.to/justinyoo/manually-removing-net-sdks-from-macos-4jce</a></p>
<p>macOS で .NET SDK を削除する方法についての記事。ツールではなく手動で削除する方法について。</p>
<ul>
<li><a href="https://docs.microsoft.com/ja-jp/dotnet/core/install/remove-runtime-sdk-versions">.NET ランタイムと SDK を削除する | Microsoft Docs</a></li>
</ul>
<h3 id="net-6.net-5-xmlserializerxml">.NET 6 と .NET 5 でXmlSerializerを用いたXML出力結果が異なる</h3>
<p><a href="https://zenn.dev/yukg/articles/d9c95e93d6932b">https://zenn.dev/yukg/articles/d9c95e93d6932b</a></p>
<p>.NET 6 の <code>XmlSerializer</code> ではパフォーマンス向上を目的としてデフォルトのシリアライズ結果としてインデントなどが含まれなくなったことについての記事。</p>
<h3 id="datetime.minvalue-new-datetime-life-like-a-clown">DateTime.MinValue や new DateTime() は危険 - Life like a clown</h3>
<p><a href="https://clown.cube-soft.jp/entry/2021/11/26/datetime-trap">https://clown.cube-soft.jp/entry/2021/11/26/datetime-trap</a></p>
<p><code>DateTime.MinValue</code> や <code>new DateTime()</code> を扱うことについての危険性についての記事。</p>
<p><code>DateTime.MinValue</code> と <code>new DateTime()</code> は <code>1/1/0001 12:00:00 AM</code> となるので、例えば JST から UTC に戻そうとして愚直に9時間を引くといったことをすると例外が発生する。記事ではこのようなケースを避けるために、最小の値としてアプリケーションで決めた固有の値を使用すること、<code>ToUniversalTime</code> を使用すること、nullable にすることなどがあげられている。</p>
<h2 id="section-2">ライブラリ、リポジトリ、ツールなど</h2>
<h3 id="elringusdotnetjs-use.net-in-any-javascript-environment-browsers-node.js-vs-code-web-extensions-etc">Elringus/DotNetJS: Use .NET in any JavaScript environment: browsers, Node.js, VS Code web extensions, etc.</h3>
<p><a href="https://github.com/Elringus/DotNetJS">https://github.com/Elringus/DotNetJS</a></p>
<p>.NET の WebAssembly 出力を Blazor ではなく、Node.js やブラウザーといった JavaScript ランタイムで動作させるためのライブラリー。.NET のコードを WebAssembly として出力し、JavaScript のコードとの相互での呼び出しが可能にする仕組みを提供する。</p>
<h3 id="xoofxsharpnng-sharpnng-is-a-lightweight-low-level-managed-wrapper-around-the-lightweight-messaging-library-nng">xoofx/SharpNng: SharpNng is a lightweight low-level managed wrapper around the Lightweight Messaging Library NNG</h3>
<p><a href="https://github.com/xoofx/SharpNng">https://github.com/xoofx/SharpNng</a></p>
<p>軽量メッセージングライブラリーの NNG の .NET のラッパーライブラリー。</p>
<ul>
<li><a href="https://nng.nanomsg.org/">NNG - nanomsg-NG</a></li>
</ul>
<!-- https://twitter.com/xoofx/status/1462118666485612548?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Hey, while I haven&#39;t been coding for a while, I just released a small .NET library called SharpNng <a href="https://t.co/myy0LNs2rX">https://t.co/myy0LNs2rX</a>, a low-level wrapper around NNG, a Lightweight Messaging Library <a href="https://t.co/clsm5vuMJT">https://t.co/clsm5vuMJT</a> 🤗</p>&mdash; Alexandre Mutel (&#64;xoofx) <a href="https://twitter.com/xoofx/status/1462118666485612548?ref_src=twsrc%5Etfw">November 20, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h2 id="section-3">サイト、ドキュメントなど</h2>
<h3 id="string.replacelineendings-method-system-microsoft-docs">String.ReplaceLineEndings Method (System) | Microsoft Docs</h3>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.string.replacelineendings?view=net-6.0">https://docs.microsoft.com/en-us/dotnet/api/system.string.replacelineendings?view=net-6.0</a></p>
<p>.NET 6 で追加された改行を一括置換するメソッド。プラットフォーム間で異なる改行を使用していることで混在してしまった場合に正規化するといったことが可能。ドキュメントではプロトコルパーサーなどでは使用しないことが推奨されている(例えば HTTP/1 は CRLF と決められている)。</p>
<p>改行として認識する文字は CR (U+000D), LF (U+000A), CRLF (U+000D U+000A), NEL (U+0085), LS (U+2028), FF (U+000C), PS (U+2029) となっている。</p>
<h3 id="section-4">ツイート</h3>
<!-- https://twitter.com/resharper/status/1462724445227921410?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">ReSharper 2021.3 EAP9 is here with some last minute improvements for C# support. Give it a try: <a href="https://t.co/Sjxn3HzpeZ">https://t.co/Sjxn3HzpeZ</a> <a href="https://t.co/rV1EgkGDH4">pic.twitter.com/rV1EgkGDH4</a></p>&mdash; JetBrains ReSharper (&#64;resharper) <a href="https://twitter.com/resharper/status/1462724445227921410?ref_src=twsrc%5Etfw">November 22, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<!-- https://twitter.com/jetbrainsrider/status/1462748608479088645?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Rider 2021.3 EAP9 is available! The major release is coming, builds are getting more stable, and C# support is improving. Try it: <a href="https://t.co/5BI4HI7lYX">https://t.co/5BI4HI7lYX</a> <a href="https://t.co/RirEDfL4cF">pic.twitter.com/RirEDfL4cF</a></p>&mdash; JetBrains Rider (&#64;JetBrainsRider) <a href="https://twitter.com/JetBrainsRider/status/1462748608479088645?ref_src=twsrc%5Etfw">November 22, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>ReSharper と Rider の 2021.3 EAP9 がリリースされたという話。</p>
<!-- https://twitter.com/okyrylchuk/status/1462910668739330049?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">In EF Core 6.0, value converters allow converting nulls.<br><br>It&#39;s useful when you have an enum with an unknown value, and it is represented as a nullable string column in a table.<br><br>⚠️ But watch out, there are pitfalls with it. Details below.<a href="https://twitter.com/hashtag/dotnet6?src=hash&amp;ref_src=twsrc%5Etfw">#dotnet6</a> <a href="https://twitter.com/hashtag/efcore6?src=hash&amp;ref_src=twsrc%5Etfw">#efcore6</a> <a href="https://twitter.com/hashtag/coding?src=hash&amp;ref_src=twsrc%5Etfw">#coding</a> <a href="https://twitter.com/hashtag/devcommunity?src=hash&amp;ref_src=twsrc%5Etfw">#devcommunity</a> <a href="https://t.co/7Rqxhsd9AN">pic.twitter.com/7Rqxhsd9AN</a></p>&mdash; Oleg Kyrylchuk (&#64;okyrylchuk) <a href="https://twitter.com/okyrylchuk/status/1462910668739330049?ref_src=twsrc%5Etfw">November 22, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Entity Framework Core 6 で ValueConverter が null をサポートできるようになったという話。</p>
<ul>
<li><a href="https://docs.microsoft.com/ja-jp/ef/core/what-is-new/ef-core-6.0/whatsnew#allow-value-converters-to-convert-nulls">値コンバーターによる null の変換を許可する | EF Core 6.0 の新機能 | Microsoft Docs</a></li>
</ul>
<!-- https://twitter.com/okyrylchuk/status/1464316831922114567?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Starting with EF Core 2.2, you could add a tag to your query for better debug purposes.<br><br>EF Core 6.0 went further, and now you can tag queries with the filename and line number of the LINQ code.<br><br>Pretty cool, huh? 😎<a href="https://twitter.com/hashtag/dotnet6?src=hash&amp;ref_src=twsrc%5Etfw">#dotnet6</a> <a href="https://twitter.com/hashtag/efcore6?src=hash&amp;ref_src=twsrc%5Etfw">#efcore6</a> <a href="https://twitter.com/hashtag/coding?src=hash&amp;ref_src=twsrc%5Etfw">#coding</a> <a href="https://twitter.com/hashtag/devcommunity?src=hash&amp;ref_src=twsrc%5Etfw">#devcommunity</a> <a href="https://t.co/XOfxfJgu9T">pic.twitter.com/XOfxfJgu9T</a></p>&mdash; Oleg Kyrylchuk (&#64;okyrylchuk) <a href="https://twitter.com/okyrylchuk/status/1464316831922114567?ref_src=twsrc%5Etfw">November 26, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Entity Framework Core 6 では <code>TagWithCallSite</code> を呼び出すことでクエリーのタグとしてファイル名と行番号を記録できるという話。</p>
<ul>
<li><a href="https://docs.microsoft.com/ja-jp/ef/core/what-is-new/ef-core-6.0/whatsnew#tag-queries-with-file-name-and-line-number">ファイル名と行番号でクエリにタグを付ける| EF Core 6.0 の新機能 | Microsoft Docs</a></li>
</ul>
<!-- https://twitter.com/okyrylchuk/status/1463629177094131715?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Previously, EF Core translated string.IsNullOrWhiteSpace into a trimming of value before checking if it&#39;s empty.<a href="https://twitter.com/MarusykRoman?ref_src=twsrc%5Etfw">&#64;MarusykRoman</a> has fixed that in EF Core 6.0🙂<a href="https://twitter.com/hashtag/dotnet6?src=hash&amp;ref_src=twsrc%5Etfw">#dotnet6</a> <a href="https://twitter.com/hashtag/efcore6?src=hash&amp;ref_src=twsrc%5Etfw">#efcore6</a> <a href="https://twitter.com/hashtag/coding?src=hash&amp;ref_src=twsrc%5Etfw">#coding</a> <a href="https://twitter.com/hashtag/devcommunity?src=hash&amp;ref_src=twsrc%5Etfw">#devcommunity</a> <a href="https://t.co/J1DTIWKQxH">pic.twitter.com/J1DTIWKQxH</a></p>&mdash; Oleg Kyrylchuk (&#64;okyrylchuk) <a href="https://twitter.com/okyrylchuk/status/1463629177094131715?ref_src=twsrc%5Etfw">November 24, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Entity Framework Core のクエリーで <code>String.IsNullOrWhitespace</code> を使用したときに発行される SQL に <code>LTRIM</code>, <code>RTRIM</code> が使用されていたが EF Core 6 ではそれらの呼び出しがなくなり、ただの空文字との比較となるという話。</p>
<p>これは SQL Server 向けの SQL トランスレーターの変更で SQL Server での文字列比較は文字列の長さが異なる場合は末尾にスペースをつけて長さを合わせての比較となる(ANSI/ISO SQL-92 に準拠した仕様)。そのため <code>'    ' = ''</code> が等しいということになるのでトリムが不要となった。</p>
<ul>
<li><a href="https://github.com/dotnet/efcore/issues/22916">SqlServer: string.IsNullOrWhiteSpace translation is overly complex · Issue #22916 · dotnet/efcore</a></li>
<li><a href="https://sql55.com/column/string-comparison.php">SQL Server - 後ろにスペースがある場合の文字列の比較について - SQL Server 入門</a></li>
</ul>
<!-- https://twitter.com/maoni0/status/1461896972038656009?s=12 -->
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">GC realtime monitor is now available as a global .NET CLI tool thanks to <a href="https://twitter.com/chnasarre?ref_src=twsrc%5Etfw">&#64;chnasarre</a>! install via <br><br>dotnet tool install -g dotnet-gcmon<br><br>very much appreciated, Christophe!!!</p>&mdash; Maoni Stephens (&#64;maoni0) <a href="https://twitter.com/maoni0/status/1461896972038656009?ref_src=twsrc%5Etfw">November 20, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>リアルタイムで GC の動作を確認できる dotnet-gcmon というツールがリリースされているという話。</p>
<h2 id="deep-dive">Deep Dive</h2>
<h3 id="allow-runtimeconfig-startuphooks-and-environment-startuphooks-to-both-be-present-by-tomdegoede-pull-request-61461-dotnetruntime">Allow runtimeconfig StartupHooks and Environment StartupHooks to both be present by tomdegoede · Pull Request #61461 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/61461">https://github.com/dotnet/runtime/pull/61461</a></p>
<p>.NET にはスタートアップ時に実行するアセンブリを指定するスタートアップフックという仕組みがあるが、runtimeconfig と環境変数のどちらかしか設定できないという問題を修正する PR。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/blob/main/docs/design/features/host-startup-hook.md">runtime/host-startup-hook.md at main · dotnet/runtime</a></li>
</ul>
<h3 id="reduce-allocations-for-createdirectory-by-adamsitnik-pull-request-61777-dotnetruntime">Reduce allocations for CreateDirectory by adamsitnik · Pull Request #61777 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/61777">https://github.com/dotnet/runtime/pull/61777</a></p>
<p>CreateDirectory メソッドの内部でシステム API を呼ぶ際 string を P/Invoke 経由で渡すのではなく、一時的なバイト配列を通して渡すことでアロケーションを削減する PR。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/blob/main/src/libraries/Common/src/System/Text/ValueUtf8Converter.cs">runtime/ValueUtf8Converter.cs at main · dotnet/runtime</a></li>
</ul>
<h3 id="add-ratelimiting-apis-by-brennanconroy-pull-request-61788-dotnetruntime">Add RateLimiting APIs by BrennanConroy · Pull Request #61788 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/61788">https://github.com/dotnet/runtime/pull/61788</a></p>
<p>RateLimiting API を追加する PR。</p>
<h3 id="xxhash6432-incorrect-one-shot-implementation-issue-61878-dotnetruntime">XXHash64/32 incorrect one-shot implementation · Issue #61878 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/issues/61878">https://github.com/dotnet/runtime/issues/61878</a></p>
<p>.NET 6 とともにリリースされた System.IO.Hashing の xxHash32/64 のハッシュをとる静的メソッドが不正な結果を返すことがある問題の Issue。</p>
<p>これは修正されてバックポート済みのため近いうちに新しいパッケージとしてリリース予定。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/pull/61923">[release/6.0] Fix XXHash for stripe size by github-actions[bot] · Pull Request #61923 · dotnet/runtime</a></li>
</ul>
<h3 id="support-zero-byte-reads-on-http-response-streams-by-mihazupan-pull-request-61913-dotnetruntime">Support zero-byte reads on HTTP response streams by MihaZupan · Pull Request #61913 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/61913">https://github.com/dotnet/runtime/pull/61913</a></p>
<p>SocketsHttpHandler でゼロバイト読み込みをサポートしたいという Issue。</p>
<p>元々は gRPC の Bidirectional streaming のような長い接続の場合、ストリームから読み取るためのバッファーが各所にあり GC ヒープの断片化を起こしてしまう。ゼロバイト読み込みが可能となれば実際にデータが必要になるまで上位ではバッファーを持つ必要がなくなるという話。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/issues/61475">SocketsHttpHandler: Support zero-byte read on response streams · Issue #61475 · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/issues/61223">[HTTP/2] Memory usage while reading from long running response streams · Issue #61223 · dotnet/runtime</a></li>
</ul>
<h3 id="added-asreadonly-extension-methods-for-idictionaryt-u-and-ilistt-by-mrxx99-pull-request-61172-dotnetruntime">Added AsReadOnly extension methods for IDictionary&lt;T, U&gt; and IList&lt;T&gt; by Mrxx99 · Pull Request #61172 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/61172">https://github.com/dotnet/runtime/pull/61172</a></p>
<p><code>IDictionary&lt;T, U&gt;</code> と <code>IList&lt;T&gt;</code> に対する <code>AsReadOnly</code> 拡張メソッドを追加する PR。</p>
<h3 id="memorystream.read-throws-argumentoutofrangexception-in.net-6-but-argumentexception-in.net-5-issue-61994-dotnetruntime">MemoryStream.Read() throws ArgumentOutOfRangexception in .NET 6 but ArgumentException in .NET 5 · Issue #61994 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/issues/61994">https://github.com/dotnet/runtime/issues/61994</a></p>
<p><code>MemoryStream.Read</code> が .NET 5 までは <code>ArgumentException</code> をスローしていたが、.NET 6 では <code>ArgumentOutOfRangexception</code> になっていたという Issue。</p>
<p><code>ArgumentOutOfRangexception</code> は <code>ArgumentException</code> を継承した型なので変更は問題ないと考えているとのこと。ただしテストコードなどで <code>ArgumentException</code> を明示していると問題となることがある。</p>
<h3 id="add-basic-implementation-of-new-rename-ui-by-ryzngard-pull-request-57686-dotnetroslyn">Add basic implementation of new rename UI by ryzngard · Pull Request #57686 · dotnet/roslyn</h3>
<p><a href="https://github.com/dotnet/roslyn/pull/57686">https://github.com/dotnet/roslyn/pull/57686</a></p>
<p>新しいリネームの UI の基本実装の PR。見た目は確定していないが今後実装される雰囲気をみることができる。</p>


      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->  
  <footer>
    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted m-0">Copyright &#xA9; Mayuki Sawatari &lt;mayuki@misuzilla.org&gt;</p>
                    <br />
                    <ul class="list-inline text-center small">
                            <li class="list-inline-item">
                                <a href="/feed.atom"><i class="fa fa-rss"></i> Feed</a>
                            </li>
                    </ul>
                    <br />
                    <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
                </div>
        </div>
    </div>
</footer>

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  


  

  <!-- Custom scripts for this template -->
  <script src="/js/clean-blog.js"></script>

</body>

</html>
