<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content=".NET &#x95A2;&#x9023;&#x306E;&#x60C5;&#x5831;&#x3092;&#x307B;&#x307C;&#x9031;&#x520A;&#x914D;&#x4FE1;">
    <meta name="author" content="Mayuki Sawatari">

  <title>2021-08-27 - WeekRef.NET</title>

  <link rel="canonical" href="/2021/08/27/updates">

      <link type="application/atom+xml" rel="alternate" title="WeekRef.NET" href="/feed.atom" />
  
  <meta name="application-name" content="WeekRef.NET" />
  <meta name="msapplication-tooltip" content="WeekRef.NET" />
  <meta name="msapplication-starturl" content="/" />

  <meta property="og:title" content="2021-08-27 - WeekRef.NET" />
    <meta property="og:image" content="/img/logo.png" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/2021/08/27/updates" />
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>
  
  <!-- Custom styles for this template -->
  <link href="/scss/clean-blog.css" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

  <!-- Lunr search -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VMZ41K2L9M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VMZ41K2L9M');
</script>


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">WeekRef.NET</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
    <li class="nav-item">
        <a class="nav-link" href="https://github.com/mayuki/WeekRef.NET">GitHub</a>
    </li>
</ul>
    </div>
  </div>
</nav>

  <!-- Page Header -->
  <header class="masthead">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="post-heading">
          <h1>
            2021-08-27
          </h1>
              <div class="meta">Published on Friday, 27 August 2021</div>
        </div>
      </div>
    </div>
  </div>
</header>

  <!-- Main Content -->
  <div class="container"> 
    <div class="row">
      <div id="content" class="col-md-12">  
        <!--
# yyyy-MM-dd
## 主なトピックス
## ヘッドライン
## アーティクル、スライドなど
## ライブラリ、リポジトリ、ツールなど
## サイト、ドキュメントなど
### ツイート
## Deep Dive
-->
<!--
# yyyy-MM-dd
## 主なトピックス
## ヘッドライン
## アーティクル、スライドなど
## ライブラリ、リポジトリ、ツールなど
## サイト、ドキュメントなど
### ツイート
## Deep Dive
-->
<h2 id="section">主なトピックス</h2>
<p><a href="https://blog.getpaint.net/2021/08/11/paint-net-4-3-alpha-build-7894/">paint.net 4.3 alpha</a> がリリースされ、α版ですが比較的有名なデスクトップアプリケーションの .NET 5 への移行が実現しています。</p>
<h2 id="section-1">ヘッドライン</h2>
<h3 id="paint.net-4.3-alpha-build-7894-paint.net-blog">paint.net 4.3 alpha (build 7894) – paint.net blog</h3>
<p><a href="https://blog.getpaint.net/2021/08/11/paint-net-4-3-alpha-build-7894/">https://blog.getpaint.net/2021/08/11/paint-net-4-3-alpha-build-7894/</a></p>
<p>paint.net 4.3 alpha がリリース。</p>
<p>このバージョンで .NET Framework から .NET 5 への移行が行われた。ユーザーからは表面上変化が見えない形での移行。</p>
<p>.NET 5 へと移行したことに伴い self-contained deployment により .NET のインストールが不要になり、パフォーマンスも向上。起動時間は AOT の効果で 5% 程度短くなる、ARM64 ビルドの提供も可能となった、など。</p>
<h3 id="update-implicit-global-usings-feature-to-address-issues-issue-19521-dotnetsdk">Update implicit global usings feature to address issues · Issue #19521 · dotnet/sdk</h3>
<p><a href="https://github.com/dotnet/sdk/issues/19521">https://github.com/dotnet/sdk/issues/19521</a></p>
<p>Preview 7 で導入した暗黙の global usings でいくつか問題が出たので C# プロジェクトでは明示的に指定しない限り有効とならないようにするよう挙動の変更。SDK 6.0.100-rc.1 にて入る予定。</p>
<ul>
<li>C# プロジェクトでは <code>DisableImplicitNamespaceImports</code> MSBuild プロパティを <code>ImplicitUsings</code> プロパティに変更
<ul>
<li>Visual Basic のプロジェクトでは引き続き <code>DisableImplicitNamespaceImports</code></li>
</ul>
</li>
<li><code>ImplictUsings</code> プロパティが <code>enable</code> または <code>true</code> と定義されている場合のみ暗黙の using が使われる</li>
<li>それに伴い .NET 6 プロジェクトのテンプレートでは <code>&lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;</code> が含まれてデフォルト有効化される形となる</li>
</ul>
<h3 id="api-proposal-attribute-for-passing-caller-identity-implicitly-issue-4984-dotnetcsharplang">[API proposal] Attribute for passing caller identity implicitly · Issue #4984 · dotnet/csharplang</h3>
<p><a href="https://github.com/dotnet/csharplang/issues/4984">https://github.com/dotnet/csharplang/issues/4984</a></p>
<p><code>CallerMemberNameAttribute</code> 属性などと同様にメソッドの引数に呼び出し元のアセンブリ、型、メソッドをコンパイル時に差し込むための属性の提案。<code>Assembly.GetCallingAssembly</code> の AOT セーフで高速な代替として。</p>
<h3 id="api-proposal-regexoptions.constrained-issue-57891-dotnetruntime">[API Proposal]: RegexOptions.Constrained · Issue #57891 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/issues/57891">https://github.com/dotnet/runtime/issues/57891</a></p>
<p>.NET 7 で正規表現エンジンに DFA モードをオプトインで追加することを検討しているので、そのためのフラグを追加する提案。</p>
<h3 id="user-story.net-7.0-developers-can-verify-more-apis-for-correct-usage-to-speed-up-their-development-57797">User Story: .NET 7.0 developers can verify more APIs for correct usage to speed up their development #57797</h3>
<p><a href="https://github.com/dotnet/runtime/issues/57797">https://github.com/dotnet/runtime/issues/57797</a></p>
<p>.NET 5 から組み込み Roslyn Analyzer が導入されたので .NET ベースライブラリの使用方法を支援するためにアナライザーを拡充しようという話の .NET 7 向けの話。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/issues/43617">User Story: .NET 6.0 developers can verify more APIs for their correct usage to speed up their development · Issue #43617 · dotnet/runtime</a></li>
</ul>
<h3 id="big-endian-platforms-not-supported-issue-35709-dotnetaspnetcore-github">Big-endian platforms not supported · Issue #35709 · dotnet/aspnetcore · GitHub</h3>
<p><a href="https://github.com/dotnet/aspnetcore/issues/35709">https://github.com/dotnet/aspnetcore/issues/35709</a></p>
<p>ASP.NET Core の様々な個所でビッグエンディアンを考慮していないため、IBM Z (s390x) で動作しないという Issue と Pull requests。</p>
<p>.NET 6 からターゲットアーキテクチャに s390x (linux-s390x) が追加され、ベースライブラリや CoreCLR へのパッチなどが入っている。現時点では CoreCLR ではなく Mono ランタイムを使用するとのこと。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/issues/52909">Add public Architecture enum value for s390x · Issue #52909 · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/pulls?q=is%3Apr+s390x+is%3Aclosed">is:pr s390x is:closed · Pull requests · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/pull/53950">Build support for s390x: installers and packages by uweigand · Pull Request #53950 · dotnet/runtime</a></li>
</ul>
<h2 id="section-2">アーティクル、スライドなど</h2>
<h3 id="the-journey-to-accessible-apps-making-visual-text-accessible-xamarin-blog">The Journey to Accessible Apps: Making Visual Text Accessible | Xamarin Blog</h3>
<p><a href="https://devblogs.microsoft.com/xamarin/the-journey-to-accessible-apps-making-visual-text-accessible/">https://devblogs.microsoft.com/xamarin/the-journey-to-accessible-apps-making-visual-text-accessible/</a></p>
<p>モバイルアプリで目に見える文字をアクセシブルにするときに考慮する点やテスト方法などについて。</p>
<h3 id="google-app-engine.net-5">Google App Engine で .NET 5 を動かす</h3>
<p><a href="https://zenn.dev/shimat/articles/4c4e292646f32e">https://zenn.dev/shimat/articles/4c4e292646f32e</a></p>
<p>Google App Engine Flexible (GAE) では.NET Core 3.1 までしかコンテナーイメージがないため .NET 5 のコンテナーをビルドする方法について。</p>
<h3 id="how-to-build-an-interactive-command-line-application-in.net">How to build an interactive command-line application in .NET</h3>
<p><a href="https://dev.to/shibayan/how-to-build-an-interactive-command-line-application-in-net-4oic">https://dev.to/shibayan/how-to-build-an-interactive-command-line-application-in-net-4oic</a></p>
<p><a href="https://github.com/shibayan/Sharprompt">Sharprompt</a> を使用して質問や選択などの入力をもつインタラクティブなコマンドラインアプリケーションの作り方。</p>
<h3 id="flavours-of-rounding">Flavours of rounding</h3>
<p><a href="https://dev.to/semuserable/flavours-of-rounding-42e0">https://dev.to/semuserable/flavours-of-rounding-42e0</a></p>
<p>.NET を含む、いろいろな言語やランタイムでの丸め (例:<code>Math.Round</code>) の例。</p>
<h3 id="cedec-2021">[CEDEC 2021] 運用中タイトルでも怖くない！ 『メルクストーリア』におけるハイパフォーマンス・ローコストなリアルタイム通信技術の導入事例</h3>
<p><a href="https://www.slideshare.net/NaoyaKishimoto/cedec-2021">https://www.slideshare.net/NaoyaKishimoto/cedec-2021</a></p>
<p><a href="https://github.com/Cysharp/MagicOnion">MagicOnion (gRPC ベースの C# RPC フレームワーク)</a> を使用した ASP.NET Core サーバー、Unity クライアントでのリアルタイム通信技術を Kubernetes 環境に Agones とともに構築した事例。</p>
<h3 id="tips-and-tricks-to-increase-your-productivity-in-visual-studio-2019">15 Tips and Tricks to Increase Your Productivity in Visual Studio 2019</h3>
<p><a href="https://arunkani-a.medium.com/15-tips-and-tricks-to-increase-your-productivity-in-visual-studio-2019-5d2329d3252f">https://arunkani-a.medium.com/15-tips-and-tricks-to-increase-your-productivity-in-visual-studio-2019-5d2329d3252f</a></p>
<p>Visual Studio 2019 で便利な小ネタ15選の紹介。</p>
<h3 id="in-c-how-do-i-get-the-descriptive-text-for-an-hresult-the-old-new-thing">In C#, how do I get the descriptive text for an HRESULT? | The Old New Thing</h3>
<p><a href="https://devblogs.microsoft.com/oldnewthing/20210826-00/?p=105609">https://devblogs.microsoft.com/oldnewthing/20210826-00/?p=105609</a></p>
<p>COM の HRESULT に対応する文字列を簡単に取得する方法。<code>Marshal.GetExceptionForHR</code> メソッドで Exception を作成して Message を取り出す。</p>
<h3 id="hidden-productivity-gems-in-resharper-and-rider-michaels-coding-spot">6 Hidden Productivity Gems in Resharper and Rider - Michael's Coding Spot</h3>
<p><a href="https://michaelscodingspot.com/productivity-in-resharper-and-rider/">https://michaelscodingspot.com/productivity-in-resharper-and-rider/</a></p>
<p>ReSharper と Rider の目立たない便利機能6選の紹介。</p>
<h3 id="bite-size-c-10-semi-auto-properties-and-field-keyword">Bite-Size C# 10 - Semi-Auto Properties and 'field' Keyword</h3>
<p><a href="https://exceptionnotfound.net/bite-size-csharp-10-semi-auto-properties-using-field-keyword/">https://exceptionnotfound.net/bite-size-csharp-10-semi-auto-properties-using-field-keyword/</a></p>
<p>C# 10 からプロパティのバッキングフィールドにアクセスする <code>field</code> キーワードが追加されるので半自動実装プロパティが実現できるという話。</p>
<h2 id="section-3">ライブラリ、リポジトリ、ツールなど</h2>
<h3 id="philippseithsignalr-signalr-server-and-client-in-go">philippseith/signalr: SignalR server and client in go</h3>
<p><a href="https://github.com/philippseith/signalr">https://github.com/philippseith/signalr</a></p>
<p>Go による SignalR のサーバーとクライアント実装。</p>
<h2 id="section-4">サイト、ドキュメントなど</h2>
<h3 id="section-5">ツイート</h3>
<blockquote>
<p>Not sure when it happened but Visual Studio 2019 is now in the Microsoft Store on Windows 11 :D pic.twitter.com/hHElUUZ5yz— Zac Bowden (&#64;zacbowden) August 24, 2021</p>
</blockquote>
<p><a href="https://twitter.com/zacbowden/status/1430183656677683219">https://twitter.com/zacbowden/status/1430183656677683219</a></p>
<p>Visual Studio 2019 が Microsoft Store (Windows 11 のストア)から入手可能に。</p>
<blockquote>
<p>IL Language view has been improved by showing opcode bytes (for next release) pic.twitter.com/iljS3gcyA1— ILSpy Team (&#64;ilspy) August 26, 2021</p>
</blockquote>
<p><a href="https://twitter.com/ilspy/status/1430882132596072451?s=12">https://twitter.com/ilspy/status/1430882132596072451?s=12</a></p>
<p>ILSpy の時期リリースで IL Language ビューにオペコードバイト列も表示されるように。</p>
<h2 id="deep-dive">Deep Dive</h2>
<h3 id="enable-sockethttphandler-to-decompress-zlib-or-deflate-by-stephentoub-pull-request-57862-dotnetruntime">Enable SocketHttpHandler to decompress zlib or deflate by stephentoub · Pull Request #57862 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/57862">https://github.com/dotnet/runtime/pull/57862</a></p>
<p>従来 SocketsHttpHandler では <code>Content-Encoding: deflate</code> を DeflateStream で展開していたところ、<code>deflate</code> の圧縮は zlib 形式で互換性がないことがあったので .NET 6 で ZLibStream クラスを新たに用意してそちらを使用するようにしたが、実際はどちらのパターンもあるので自動でスイッチするようにするという PR。</p>
<ul>
<li><a href="https://github.com/dotnet/runtime/pull/57940">[release/6.0-rc1] Enable SocketHttpHandler to decompress zlib or deflate by github-actions · Pull Request #57940 · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/issues/38022">HttpClient doesn't decompress &quot;deflate&quot; correctly · Issue #38022 · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/pull/42717">Implement ZLibStream and fix SocketsHttpHandler deflate support by stephentoub · Pull Request #42717 · dotnet/runtime</a></li>
<li><a href="https://github.com/dotnet/runtime/issues/57604">HttpClient deflate decompression error · Issue #57604 · dotnet/runtime</a></li>
</ul>
<h3 id="update-components-to-use-loggermessage-by-pranavkm-pull-request-35585-dotnetaspnetcore">Update Components to use LoggerMessage by pranavkm · Pull Request #35585 · dotnet/aspnetcore</h3>
<p><a href="https://github.com/dotnet/aspnetcore/pull/35585">https://github.com/dotnet/aspnetcore/pull/35585</a></p>
<p>ASP.NET Core での Source Generator を使用したロガーへの置き換えの PR。</p>
<h3 id="use-lambda-expression-and-method-group-signature-in-type-inference-by-cston-pull-request-55786-dotnetroslyn-github">Use lambda expression and method group signature in type inference by cston · Pull Request #55786 · dotnet/roslyn · GitHub</h3>
<p><a href="https://github.com/dotnet/roslyn/pull/55786">https://github.com/dotnet/roslyn/pull/55786</a></p>
<p>ラムダ式の型推論の強化の PR。</p>
<h3 id="migrate-loggermessagegenerator-to-iincrementalgenerator-by-eerhardt-pull-request-58068-dotnetruntime">Migrate LoggerMessageGenerator to IIncrementalGenerator by eerhardt · Pull Request #58068 · dotnet/runtime</h3>
<p><a href="https://github.com/dotnet/runtime/pull/58068">https://github.com/dotnet/runtime/pull/58068</a></p>
<p>ロガーのコード生成を行う Source Generator である LoggerMessageGenerator を新しい仕組みの IIncrementalGenerator に移行したいという PR。</p>
<h3 id="web-relax-the-induced-gc-strategy-in-serverdispatcher-by-sharwell-pull-request-55814-dotnetroslyn">Web Relax the induced GC strategy in ServerDispatcher by sharwell · Pull Request #55814 · dotnet/roslyn</h3>
<p><a href="https://github.com/dotnet/roslyn/pull/55814">https://github.com/dotnet/roslyn/pull/55814</a></p>
<p>VBCSCompiler (コンパイラーサーバー) がクリーンナップのために定期的に GC を実行するが、何度も実行する形になっていて CPU を消費しているので <code>GC.GetTotalMemory(forceFullCollection: true);</code> 一回で終わらせるようにする PR。</p>
<ul>
<li><a href="https://github.com/dotnet/roslyn/issues/55807">Roslyn Compiler Service is forcing unneeded GCs, wasting CPU time · Issue #55807 · dotnet/roslyn</a></li>
</ul>
<p>元々は VBCSCompiler がメモリリークしている(ように見えているだけ)という強いフィードバックがあり、見かけ上減らしたかったためこのようなコードを実行していた。この処理を行うことでのパフォーマンス上のインパクトは大きくないかあるいは WeakReference が回収される分悪くなる可能性もある。なお GC を11回実行していたのは実験した結果、GC 中の Finalizer などで生き残ってしまうものも含めて処理するにはそれぐらいが良かったからとのこと。</p>
<p><code>GC.GetTotalMemory(forceFullCollection: true)</code> では同様に繰り返し GC を呼び出して縮めるがある程度効果のあるまでという仕組みになっている。
<a href="https://github.com/dotnet/runtime/blob/7994e5940d8e093e6a7a6008358b539f9d8a352d/src/coreclr/System.Private.CoreLib/src/System/GC.cs#L331-L353">https://github.com/dotnet/runtime/blob/7994e5940d8e093e6a7a6008358b539f9d8a352d/src/coreclr/System.Private.CoreLib/src/System/GC.cs#L331-L353</a></p>
<h3 id="automatically-provide-global-using-by-kzu-pull-request-516-spectreconsolespectre.console">Automatically provide global using by kzu · Pull Request #516 · spectreconsole/spectre.console</h3>
<p><a href="https://github.com/spectreconsole/spectre.console/pull/516">https://github.com/spectreconsole/spectre.console/pull/516</a></p>
<p>パッケージに .props を入れておくことで global usings を有効にする方法を使った例</p>


      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->  
  <footer>
    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted m-0">Copyright &#xA9; Mayuki Sawatari &lt;mayuki@misuzilla.org&gt;</p>
                    <br />
                    <ul class="list-inline text-center small">
                            <li class="list-inline-item">
                                <a href="/feed.atom"><i class="fa fa-rss"></i> Feed</a>
                            </li>
                    </ul>
                    <br />
                    <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
                </div>
        </div>
    </div>
</footer>

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  


  

  <!-- Custom scripts for this template -->
  <script src="/js/clean-blog.js"></script>

</body>

</html>
